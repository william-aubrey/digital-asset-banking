/* Reset-ish */
* { box-sizing: border-box; }
html, body { height: 100%; margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }

:root {
  --grid: 10px;
  --border: #111;
  --muted: #9ca3af;
  --handle: #cbd5e1;
  --handle-hover: #111;
  --handle-active: #fb923c;
  --function-bg: #fff;
}

/* Full-height app frame INSIDE the component: 10 / 80 / 10 */
#app-root {
  width: 100vw;
  height: 100svh;   /* mobile safe */
  height: 100dvh;   /* modern desktop */
  display: grid;
  grid-template-rows: 10% 80% 10%;
  overflow: hidden; /* no internal scroll */
  gap: 0;
}

/* Top/bottom bars: inset shadows instead of borders (no layout height) */
.topbar, .bottombar {
  display: flex;
  justify-content: space-between;
  gap: .6rem;
  padding: .4rem .6rem;
  box-shadow: inset 0 -2px #111;  /* bottom line for topbar */
  background: #fafafa;
  min-height: 0;
  overflow: hidden;
}
.bottombar { box-shadow: inset 0 2px #111; } /* top line for bottombar */

.topbar .left, .topbar .right { display: flex; align-items: end; gap: .5rem; flex-wrap: wrap; }
.field { display: grid; gap: .2rem; }
.field label { font-size: .75em; color: #374151; text-transform: uppercase; }
.field input, .field select { padding: .25rem .35rem; border: 1px solid #9ca3af; border-radius: .25rem; min-width: 7.5rem; }

.buttons { display: flex; gap: .35rem; flex-wrap: wrap; }
button { border: 1px solid #111; background: #fff; padding: .3rem .5rem; border-radius: .35rem; cursor: pointer; font-size: .95em; }
button:active { transform: translateY(1px); }

/* Canvas fills the middle row, zero overflow */
.canvas-wrap { position: relative; min-height: 0; overflow: hidden; }
.canvas-wrap .grid {
  position: absolute; inset: 0;
  /* NEW: give the canvas a white base so the grid sits on white */
  background-color: #fff;

  background-image:
    linear-gradient(to right, #eee 1px, transparent 1px),
    linear-gradient(to bottom, #eee 1px, transparent 1px);
  background-size: var(--grid) var(--grid);
  background-position: -1px -1px;
  pointer-events: none;
  z-index: 0;
}

#svg.canvas {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  display: block; z-index: 1;
  touch-action: none;
}

/* Nodes / handles / edges */
.g-node { cursor: move; }
.node-box { fill: var(--function-bg); stroke: var(--border); stroke-width: 2px; rx: 0; ry: 0; }
.node-name { font-weight: 700; font-size: 14px; }
.node-number { font-size: 12px; }

.handle { r: 6; fill: #fff; stroke: var(--handle); stroke-width: 2; pointer-events: all; }
.handle:hover { stroke: var(--handle-hover); }
.handle.active { fill: var(--handle-active); stroke: var(--handle-hover); }

.edge-path { fill: none; stroke: #111; stroke-width: 2; }
.arrowhead { fill: #111; }
.stub { stroke: #111; stroke-width: 2; }
.stub-arrowhead { fill: #111; }
.edge-label, .stub-label { font-size: 12px; dominant-baseline: middle; user-select: none; }
.selected .node-box { stroke-dasharray: 4 3; }

/* Floating label editor */
.label-editor {
  position: absolute; display: none; gap: .25rem;
  background: #fff; border: 1px solid #111; padding: .25rem; border-radius: .35rem;
  box-shadow: 0 6px 16px rgba(0,0,0,.15); z-index: 1000;
}
.label-editor .label-row { display: flex; gap: .25rem; }
