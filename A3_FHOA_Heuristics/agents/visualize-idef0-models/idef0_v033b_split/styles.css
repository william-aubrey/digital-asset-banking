/* Reset-ish */
* { box-sizing: border-box; }
html, body { height: 100%; margin: 0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }

:root {
  --grid: 10px;
  --border: #111;
  --muted: #9ca3af;
  --handle: #cbd5e1;
  --handle-hover: #111;
  --handle-active: #fb923c; /* orange fill when active */
  --function-bg: #fff;
}

/* Top metadata bar */
.topbar, .bottombar {
  display: flex;
  justify-content: space-between;
  gap: .75rem;
  padding: .5rem .75rem;
  border-bottom: 2px solid #111;
  background: #fafafa;
}
.bottombar { border-top: 2px solid #111; border-bottom: none; }

.topbar .left, .topbar .right { display: flex; align-items: end; gap: .5rem; flex-wrap: wrap; }
.field { display: grid; gap: .25rem; }
.field label { font-size: .75rem; color: #374151; text-transform: uppercase; }
.field input, .field select { padding: .3rem .4rem; border: 1px solid #9ca3af; border-radius: .25rem; min-width: 8rem; }

.buttons { display: flex; gap: .4rem; }
button { border: 1px solid #111; background: #fff; padding: .35rem .6rem; border-radius: .35rem; cursor: pointer; }
button:active { transform: translateY(1px); }

/* Canvas */
.canvas-wrap { position: relative; height: calc(100vh - 164px);  /* rough: bars + paddings */ }
.grid {
  position: absolute; inset: 0;
  background-image:
    linear-gradient(to right, #eee 1px, transparent 1px),
    linear-gradient(to bottom, #eee 1px, transparent 1px);
  background-size: var(--grid) var(--grid);
  pointer-events: none;
}
.canvas { position: absolute; inset: 0; width: 100%; height: 100%; }

/* Function Box */
.g-node { cursor: move; }
.node-box {
  fill: var(--function-bg); stroke: var(--border); stroke-width: 2px; rx: 0; ry: 0;
}
.node-name { font-weight: 700; font-size: 14px; }
.node-number { font-size: 12px; }
.handle {
  r: 6; fill: #fff; stroke: var(--handle); stroke-width: 2;
}
.handle:hover { stroke: var(--handle-hover); }
.handle.active { fill: var(--handle-active); stroke: var(--handle-hover); }

/* Edge and stub styling */
.edge-path { fill: none; stroke: #111; stroke-width: 2; }
.arrowhead { fill: #111; }
.stub { stroke: #111; stroke-width: 2; }
.stub-arrowhead { fill: #111; }

.edge-label, .stub-label { font-size: 12px; dominant-baseline: middle; user-select: none; }

/* Selection hints */
.selected .node-box { stroke-dasharray: 4 3; }

/* Label editor */
.label-editor {
  position: absolute; display: none; gap: .25rem;
  background: #fff; border: 1px solid #111; padding: .25rem; border-radius: .35rem;
  box-shadow: 0 6px 16px rgba(0,0,0,.15); z-index: 1000;
}
.label-editor .label-row { display: flex; gap: .25rem; }
